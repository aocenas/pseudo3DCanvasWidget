(function(){var a,b,c;(function(){function g(a,b){if(a&&a.charAt(0)==="."&&b){b=b.split("/"),b=b.slice(0,b.length-1),a=b.concat(a.split("/"));var c,d;for(c=0;d=a[c];c++)if(d===".")a.splice(c,1),c-=1;else if(d==="..")if(c!==1||a[2]!==".."&&a[0]!=="..")c>0&&(a.splice(c-1,2),c-=2);else break;a=a.join("/")}return a}function h(a,b){return function(){return f.apply(null,e.call(arguments,0).concat([a,b]))}}function i(a){return function(b){return g(b,a)}}function j(a){return function(b){d[a]=b}}function k(a,b){var c,e,f=a.indexOf("!");return f!==-1?(c=g(a.slice(0,f),b),a=a.slice(f+1),e=d[c],e&&e.normalize?a=e.normalize(a,i(b)):a=g(a,b)):a=g(a,b),{f:c?c+"!"+a:a,n:a,p:e}}function l(a,b,c,e){var f=[],g,i,l,m,n,o;e||(e=a);if(typeof c=="function"){if(b)for(m=0;m<b.length;m++)o=k(b[m],e),l=o.f,l==="require"?f[m]=h(a):l==="exports"?(f[m]=d[a]={},g=!0):l==="module"?i=f[m]={id:a,uri:"",exports:d[a]}:l in d?f[m]=d[l]:o.p&&(o.p.load(o.n,h(e,!0),j(l),{}),f[m]=d[l]);n=c.apply(d[a],f),a&&(i&&i.exports!==undefined?d[a]=i.exports:g||(d[a]=n))}else a&&(d[a]=c)}var d={},e=[].slice,f;if(typeof c=="function")return;a=f=function(a,b,c,e){return typeof a=="string"?d[k(a,b).f]:(a.splice||(b.splice?(a=b,b=arguments[2]):a=[]),e?l(null,a,b,c):setTimeout(function(){l(null,a,b,c)},15),f)},f.config=function(){return f},b||(b=f),c=function(a,b,c){b.splice||(c=b,b=[]),l(a,b,c)},c.amd={jQuery:!0}})(),c("../lib/almond",function(){}),c("console",[],function(){return window.console||(console={}),console.log=console.log||function(){},console}),c("Point",["console"],function(a){var b=function(a,b,c,d,e){this.x=a,this.y=b,this.z=c,this.diameter=d,this.color=e};return b.prototype={rotate:function(b,c,d,e){if(!this.isSamePosition(e)){a.log("rotating point x,y,z = "+this.x+","+this.y+","+this.z),a.log("angle xy,xz,yz "+b/Math.PI+"PI,"+c/Math.PI+"PI,"+d/Math.PI+"PI, around x,y,z = "+e.x+","+e.y+","+e.z);var f=this;[[b,"x","y"],[c,"x","z"],[d,"y","z"]].filter(function(a){return a[0]!==0}).forEach(function(b){a.log("rotating in plane "+b[1]+b[2]+" by "+b[0]);var c={x:f.x-e.x,y:f.y-e.y,z:f.z-e.z},d=Math.round(Math.sqrt(Math.pow(c[b[2]],2)+Math.pow(c[b[1]],2)));if(d!=0){var g=c[b[1]]<0?c[b[2]]<0?3:4:c[b[2]]<0?2:1,h=Math.asin(Math.abs(c[b[1]])/d);switch(g){case 1:break;case 2:h=Math.PI-h;break;case 3:h=Math.PI+h;break;case 4:h=Math.PI*2-h}a.log("angleFromCenter = "+h/Math.PI+"PI"),f[b[1]]=Math.round((Math.sin(b[0]+h)*d+e[b[1]])*1e6)/1e6,f[b[2]]=Math.round((Math.cos(b[0]+h)*d+e[b[2]])*1e6)/1e6,a.log("after rotation x,y,z = "+f.x+","+f.y+","+f.z)}})}},toString:function(){return"x"+this.x+"y"+this.y+"z"+this.z},isSamePosition:function(a){return this.x===a.x&&this.y===a.y&&this.z===a.z}},b}),c("Color",[],function(){return function(a,b,c){this.rgb="rgb("+a+","+b+","+c+")"}}),c("globals",[],function(){var a=5,b=15,c=400,d=200,e=200,f=200,g=c/2,h=d/2;return{POINT_RADIUS:a,GRID_SPACING:b,CONTEXT_WIDTH:c,CONTEXT_HEIGHT:d,CONTEXT_DISTANCE:e,Z00:f,X00:g,Y00:h}}),c("PointGrid",["console","Point","globals","Color"],function(a,b,c,d){var e=function(a){this.mapGrid=a,this.points=[];for(var e=0,f=a.length;e<f;e++)for(var g=0,h=a[e].length;g<h;g++)for(var i=0,j=a[e][g].length;i<j;i++)if(a[e][g][i]==1){var k=i-Math.floor(j/2),l=g-Math.floor(h/2),m=e-Math.floor(f/2),n=k*c.GRID_SPACING+c.X00,o=l*c.GRID_SPACING+c.Y00,p=m*c.GRID_SPACING+c.Z00;this.points[this.points.length]=new b(n,o,p,c.POINT_RADIUS,new d(0,0,0))}};return e.prototype={rotate:function(a,b,c,d){this.points.forEach(function(e){e.rotate(a,b,c,d)})}},e}),c("Context3D",["console","globals","Point","PointGrid"],function(a,b,c,d){var e=function(a){this.canvas=a,this.context=a.getContext("2d"),this.model=[]};return e.prototype={drawPoint:function(c){if(c){a.log("Drawing point x = "+c.x+", y = "+c.y+", z = "+c.z+", radius = "+c.diameter);var d=(b.CONTEXT_WIDTH-b.CONTEXT_WIDTH/c.z*b.CONTEXT_DISTANCE)/2,e=(b.CONTEXT_HEIGHT-b.CONTEXT_HEIGHT/c.z*b.CONTEXT_DISTANCE)/2,f=c.x/c.z*b.CONTEXT_DISTANCE+d,g=c.y/c.z*b.CONTEXT_DISTANCE+e,h=c.diameter/c.z*b.CONTEXT_DISTANCE;a.log("Drawing to posX = "+f+", posY = "+g+", radius = "+h),h>0&&f-h>0&&f+h<b.CONTEXT_WIDTH&&g-h>0&&g+h<b.CONTEXT_HEIGHT&&(this.context.fillStyle=c.rgb,this.context.moveTo(f+h,g),this.context.arc(f,g,h,0,Math.PI*2,!1))}},fill:function(){this.context.fill()},beginPath:function(){this.context.beginPath()},drawPointGrid:function(a){a&&a.points.forEach(function(a){this.drawPoint(a)},this)},clear:function(){this.canvas.width=this.canvas.width},clearModel:function(){this.clear(),this.model={}},draw:function(){this.clear(),this.model.length>0&&(this.beginPath(),this.model.forEach(function(a){a instanceof c?this.drawPoint(a):this.drawPointGrid(a)},this),this.fill())},addModel:function(a){a&&(a instanceof c?this.model.push(a):this.model.push(new d(a)))},rotate:function(a,b){this.model.forEach(function(b){b.rotate(a.xy,a.xz,a.yz,a.center)}),b||this.draw()}},e}),c("Pseudo3D",["Context3D","PointGrid","globals"],function(a,b,c){return window.Pseudo3D=window.Pseudo3D||function(b){if(!b)return null;typeof b=="string"&&(b=document.getElementById(b));var c=new a(b);return{draw:function(){return c.draw(),this},clear:function(){return c.clear(),this},rotate:function(a,b){return c.rotate(a,b),this},rotateXY:function(a,b){return c.rotate({xy:a,xz:0,yz:0,center:b},!1),this},rotateXZ:function(a,b){return c.rotate({xy:0,xz:a,yz:0,center:b},!1),this},rotateYZ:function(a,b){return c.rotate({xy:0,xz:0,yz:a,center:b},!1),this},clearModel:function(){return c.clearModel(),this},addModel:function(a){return c.addModel(a),this}}},window.Pseudo3D})})()